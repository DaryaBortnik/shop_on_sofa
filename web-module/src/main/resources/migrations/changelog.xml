
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd">

    <changeSet id="CREATE_TABLE_ROLE" author="darya.bortnik.churilovich@gmail.com">
        <createTable tableName="role">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="description" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="CREATE_TABLE_USER" author="darya.bortnik.churilovich@gmail.com">
        <createTable tableName="user">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="email" type="varchar(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="password" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="role_id" type="BIGINT">
                <constraints nullable=" false"
                             foreignKeyName="f_role_id" references="role(id)"/>
            </column>
            <column name="is_deleted" type="Boolean" defaultValue="false">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="CREATE_TABLE_USER_PROFILE" author="darya.bortnik.churilovich@gmail.com">
        <createTable tableName="user_profile">
            <column name="user_id" type="BIGINT">
                <constraints primaryKey="true"
                             foreignKeyName="f_user_id_profile" references="user(id)" deleteCascade="true"
                             nullable="false"/>
            </column>
            <column name="first_name" type="varchar(20)">
            </column>
            <column name="middle_name" type="varchar(40)">
            </column>
            <column name="last_name" type="varchar(40)">
            </column>
            <column name="address" type="varchar(400)">
            </column>
            <column name="phone_number" type="varchar(40)">
            </column>
        </createTable>
    </changeSet>

    <changeSet id="CREATE_TABLE_REVIEW" author="darya.bortnik.churilovich@gmail.com">
        <createTable tableName="review">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="description" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="add_date" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="is_shown" type="Boolean" defaultValue="false">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable=" false"
                             foreignKeyName="f_user_id" references="user(id)" deleteCascade="true"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="CREATE_TABLE_ARTICLE" author="darya.bortnik.churilovich@gmail.com">
        <createTable tableName="article">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="short_description" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="full_description" type="varchar(1000)">
                <constraints nullable="false"/>
            </column>
            <column name="add_date" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable=" false"
                             foreignKeyName="f_article_user_id" references="user(id)" deleteCascade="true"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="CREATE_TABLE_COMMENT" author="darya.bortnik.churilovich@gmail.com">
        <createTable tableName="comment">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="description" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="add_date" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable=" false"
                             foreignKeyName="f_comment_user_id" references="user(id)" deleteCascade="true"/>
            </column>
            <column name="article_id" type="BIGINT">
                <constraints nullable=" false"
                             foreignKeyName="f_comment_article_id" references="article(id)" deleteCascade="true"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="CREATE_TABLE_ITEM_CATEGORY" author="darya.bortnik.churilovich@gmail.com">
        <createTable tableName="item_category">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="CREATE_TABLE_ITEM" author="darya.bortnik.churilovich@gmail.com">
        <createTable tableName="item">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="unique_number" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="price" type="DECIMAL(10,2)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="item_category_id" type="BIGINT">
                <constraints nullable=" false"
                             foreignKeyName="f_item_category_id" references="item_category(id)" deleteCascade="true"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable=" false"
                             foreignKeyName="f_item_user_id" references="user(id)" deleteCascade="true"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="CREATE_TABLE_ORDERS" author="darya.bortnik.churilovich@gmail.com">
        <createTable tableName="orders">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="order_number" type="varchar(200)">
                <constraints nullable="false"/>
            </column>
            <column name="add_date" type="DATE">
                <constraints nullable="false"/>
            </column>
            <column name="status" type="varchar(100)">
                <constraints nullable="false"/>
            </column>
            <column name="price" type="DECIMAL(10,2)">
                <constraints nullable="false"/>
            </column>
            <column name="item_amount" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="item_id" type="BIGINT">
                <constraints nullable=" false"
                             foreignKeyName="f_order_item_id" references="item(id)" deleteCascade="true"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable=" false"
                             foreignKeyName="f_order_user_id" references="user(id)" deleteCascade="true"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="INSERT_ROLE_ADMINISTRATOR" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="role">
            <column name="name" value="ADMINISTRATOR"/>
            <column name="description"
                    value="Admin can see list of all users, add new user, change user role, see all reviews and change their is_shown status"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ROLE_SALE_USER" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="role">
            <column name="name" value="SALE_USER"/>
            <column name="description"
                    value="Sale user can do almost all, but everything is also within his competence"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ROLE_CUSTOMER_USER" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="role">
            <column name="name" value="CUSTOMER_USER"/>
            <column name="description"
                    value="Customer user can see all articles, chosen article and update own profile"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ROLE_SECURE_API_USER" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="role">
            <column name="name" value="SECURE_API_USER"/>
            <column name="description"
                    value="Secure API user can do all things with articles and add new user"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_USER_WITH_ADMIN_ROLE" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="user">
            <column name="email" value="admin@ad.com"/>
            <column name="password" value="$2y$12$4wENuTsw.DyvCk7EF2m90.xU4eDLxEdud15XsKyMfzdx7T5JQsq7e"/>
            <column name="role_id" valueComputed="(SELECT id FROM role WHERE name = 'ADMINISTRATOR')"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_USER_WITH_SALE_USER_ROLE" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="user">
            <column name="email" value="sale@ad.com"/>
            <column name="password" value="$2y$12$4wENuTsw.DyvCk7EF2m90.xU4eDLxEdud15XsKyMfzdx7T5JQsq7e"/>
            <column name="role_id" valueComputed="(SELECT id FROM role WHERE name = 'SALE_USER')"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_USER_WITH_CUSTOMER_USER_ROLE" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="user">
            <column name="email" value="custom@ad.com"/>
            <column name="password" value="$2y$12$4wENuTsw.DyvCk7EF2m90.xU4eDLxEdud15XsKyMfzdx7T5JQsq7e"/>
            <column name="role_id" valueComputed="(SELECT id FROM role WHERE name = 'CUSTOMER_USER')"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_USER_WITH_ SECURE_API_USER_ROLE" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="user">
            <column name="email" value="secureapi@ad.com"/>
            <column name="password" value="$2y$12$4wENuTsw.DyvCk7EF2m90.xU4eDLxEdud15XsKyMfzdx7T5JQsq7e"/>
            <column name="role_id" valueComputed="(SELECT id FROM role WHERE name = 'SECURE_API_USER')"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_USER_INFO_FOR_USER_ADMIN" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="user_profile">
            <column name="user_id" valueComputed="(SELECT id FROM user WHERE email = 'admin@ad.com')"/>
            <column name="first_name" value="test_first_name"/>
            <column name="middle_name" value="test_middle_name"/>
            <column name="last_name" value="test_last_name"/>
            <column name="address" value="test_address"/>
            <column name="phone_number" value="541258855"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ITEM_CATEGORY_BEAUTY" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="item_category">
            <column name="name" value="BEAUTY"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ITEM_CATEGORY_MEN" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="item_category">
            <column name="name" value="MEN"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ITEM_CATEGORY_WOMEN" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="item_category">
            <column name="name" value="WOMEN"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ITEM_CATEGORY_KIDS" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="item_category">
            <column name="name" value="KIDS"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ITEM_CATEGORY_HOUSE_AND_LIVING" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="item_category">
            <column name="name" value="HOUSE AND LIVING"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ITEM_CATEGORY_ELECTRONICS" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="item_category">
            <column name="name" value="ELECTRONICS"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ITEM_CATEGORY_SPORT" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="item_category">
            <column name="name" value="SPORT"/>
        </insert>
    </changeSet>

    <changeSet id="INSERT_ITEM_CATEGORY_AUTOMOBILES" author="darya.bortnik.churilovich@gmail.com">
        <insert tableName="item_category">
            <column name="name" value="AUTOMOBILES"/>
        </insert>
    </changeSet>

</databaseChangeLog>
